{"version":3,"sources":["webpack:///webpack/bootstrap 52609800da951315b727","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///./nuxt.config.js","webpack:///external \"fs\"","webpack:///external \"koa\"","webpack:///external \"koa-router\"","webpack:///external \"koa-static\"","webpack:///external \"nuxt\"","webpack:///external \"path\"","webpack:///external \"raspivid\"","webpack:///external \"regenerator-runtime\"","webpack:///./server/index.js"],"names":["module","exports","head","title","meta","charset","name","content","hid","link","rel","type","href","css","loading","color","config","require","dev","app","env","nuxt","build","console","error","process","exit","use","serve","resolve","__dirname","router","get","ctx","url","file","createWriteStream","video","raspivid","pipe","body","createReadStream","routes","middleware","next","status","render","req","res","listen","port","host","log","start","PORT"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 52609800da951315b727","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'starter',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ]\n  },\n  /*\n  ** Global CSS\n  */\n  css: ['~assets/css/main.css'],\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: { color: '#3B8070' }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"raspivid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"raspivid\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 9\n// module chunks = 0","import Koa from 'koa'\nimport Nuxt from 'nuxt'\nimport Router from 'koa-router'\nimport raspivid from 'raspivid'\nimport { createWriteStream, createReadStream } from 'fs'\nimport { resolve } from 'path'\n// import shelljs from 'shelljs'\nimport serve from 'koa-static'\n\nconst app = new Koa()\nconst router = new Router()\nconst host = app.env === 'production'\n  ? '192.168.1.111'\n  : '127.0.0.1'\n\nconst port = process.env.PORT || 3000\n\nasync function start () {\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n  const nuxt = await new Nuxt(config)\n\n  if (config.dev) {\n    try {\n      await nuxt.build()\n    } catch (e) {\n      console.error(e) // eslint-disable-line no-console\n      process.exit(1)\n    }\n  }\n\n  app.use(serve(resolve(__dirname, '../public')))\n\n  router.get('/stream', async ctx => {\n    if (config.dev === 'production') {\n      const url = resolve(__dirname, '../public/video.mp4')\n      var file = createWriteStream(url)\n      var video = raspivid()\n\n      video.pipe(file)\n\n      return (ctx.body = createReadStream(url))\n    }\n\n    ctx.body = 'dev'\n  })\n\n  router.get('/test', async ctx => {\n    ctx.body = 'test'\n  })\n\n  app\n    .use(router.routes())\n    .use(router.middleware())\n\n  app.use(async (ctx, next) => {\n    ctx.status = 200\n    await nuxt.render(ctx.req, ctx.res)\n  })\n\n  app.listen(port, host)\n  console.log(`Server listening on ${host}:${port}`)\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}